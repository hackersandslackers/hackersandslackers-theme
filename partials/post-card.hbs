{{!-- This is a partial file used to generate a post "card"
which templates loop over to generate a list of posts. --}}

<article class="post-card {{#match @custom.feed_layout "Classic"}}{{/match}}{{#match @custom.feed_layout "Grid"}} keep-ratio{{/match}}{{#unless access}} post-access-{{visibility}}{{/unless}}">

    {{#if feature_image}}
    <a class="post-card-image-link" href="{{url}}">

        {{!-- This is a responsive image, it loads different sizes depending on device
        https://medium.freecodecamp.org/a-guide-to-responsive-images-with-ready-to-use-templates-c400bd65c433 --}}
        <img class="post-card-image"
            srcset="{{img_url feature_image size="s"}} 300w,
                    {{img_url feature_image size="m"}} 600w,
                    {{img_url feature_image size="l"}} 1000w,
                    {{img_url feature_image size="xl"}} 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="{{img_url feature_image size="m"}}"
            alt="{{#if feature_image_alt}}{{feature_image_alt}}{{else}}{{title}}{{/if}}"
            loading="lazy"
        />

        {{#unless access}}
        {{^has visibility="public"}}
            <div class="post-card-access">
                {{> "icons/lock"}}
                {{#has visibility="members"}}
                    Members only
                {{else}}
                    Paid-members only
                {{/has}}
            </div>
        {{/has}}
        {{/unless}}

    </a>
    {{/if}}

    <div class="post-card-content">

        <a class="post-card-content-link" href="{{url}}">
            <header class="post-card-header">
                <h2 class="post-card-title">
                    {{#unless access}}
                    {{^has visibility="public"}}
                        {{#unless feature_image}}
                            {{> "icons/lock"}}
                        {{/unless}}
                    {{/has}}
                    {{/unless}}
                    {{title}}
                </h2>
            </header>
            {{#if excerpt}}
                <div class="post-card-excerpt">{{excerpt}}</div>
            {{/if}}
        </a>

        <footer class="post-card-meta">
            <div class="meta-items-left">
                {{#primary_author}}
                        {{#if profile_image}}
                            <a href="{{url}}" class="post-card-author-avatar">
                                <img class="post-card-author-image" src="{{img_url profile_image size="xs"}}" alt="{{name}}" />
                            </a>
                        {{else}}
                            <a href="{{url}}" class="post-card-author-avatar">{{> "icons/avatar"}}</a>
                        {{/if}}
                {{/primary_author}}

                <div>
                    {{#primary_author}}
                        <a href="{{url}}" class="post-card-author-name">
                            {{name}}
                        </a>
                    {{/primary_author}}
                    <div class="post-card-meta-details">
                        <span class="post-card-meta-item">
                            <time class="post-card-meta-date" datetime="{{date format="DD-MMM-YYYY"}}">{{date}}</time>
                        </span>
                        {{#if reading_time}}
                            <span class="post-card-meta-item">â€¢</span>
                            <span class="post-card-meta-item">{{reading_time}}</span>
                        {{/if}}
                    </div>
                </div>

            </div>

            {{#primary_tag}}
                <a href="{{url}}" style="background:{{accent_color}}; box-shadow: inset 0 0 0 1px {{accent_color}};" class="post-card-primary-tag">{{name}}</a>
            {{/primary_tag}}
        </footer>

    </div>

</article>
